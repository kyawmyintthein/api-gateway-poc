{
    "version": 2,
    "timeout": "3000ms",
    "cache_ttl": "300s",
    "debug": true,
    "port": 8000,
    "extra_config": {
        "github_com/devopsfaith/krakend-metrics": {
            "collection_time": "30s",
            "listen_address": ":8090"
        },
        "github_com/letgoapp/krakend-influx": {
            "address": "http://influxdb:8086",
            "ttl": "25s"
        },
        "github_com/devopsfaith/krakend-gologging": {
            "level": "DEBUG",
            "prefix": "[KRAKEND]",
            "syslog": false,
            "stdout": true,
            "format": "logstash"
        },
        "github_com/devopsfaith/krakend-opencensus": {
            "sample_rate": 100,
            "reporting_period": 1,
            "exporters": {
                "jaeger": {
                    "endpoint": "http://jaeger:14268/api/traces",
                    "service_name": "krakend"
                }
            }
        },
        "github_com/devopsfaith/krakend-logstash": {
            "enabled": true
        },
        "github_com/devopsfaith/krakend-cors": {
            "allow_origins": ["http://localhost:8080", "http://localhost:3000", "http://192.168.99.100:3000"],
            "allow_methods": ["POST", "GET"],
            "allow_headers": ["Origin", "Authorization", "Content-Type"],
            "expose_headers": ["Content-Length"],
            "max_age": "12h"
        },
        "github_com/devopsfaith/bloomfilter": {
            "N": 10000000,
            "P": 0.0000001,
            "HashName": "optimal",
            "TTL": 1500,
            "port": 1234,
            "TokenKeys": ["jti"]
        }
    },
    "endpoints": [{
            "endpoint": "/svc/post",
            "method": "POST",
            "output_encoding": "json",
            "querystring_params": [
                "*"
            ],
            "headers_to_pass": [
                "*"
            ],
            "backend": [{
                "url_pattern": "/rz/rpc.svcc.CService/CallServiceC",
                "encoding": "json",
                "sd": "custom",
                "method": "POST",
                "extra_config": {
                    "github.com/kyawmyintthein/lura-twirp/martian": {
                        "body.Modifier": {
                            "scope": ["response"],
                            "template": "WwogICAgewogICJvcGVyYXRpb24iOiAic2hpZnQiLAogICJzcGVjIjogewogICAgInJlc3VsdCI6ICJyZXNwb25zZXMiCiAgfQp9XQ==",
                            "method": "POST"
                        }
                    }
                },
                "host": [
                    "http://localhost:8083"

                ],

                "disable_host_sanitize": true
            }]
        },
        {
            "endpoint": "/rpc/post",
            "method": "POST",
            "output_encoding": "json",
            "querystring_params": [
                "*"
            ],
            "headers_to_pass": [
                "*"
            ],
            "extra_config": {
                "twirp_service_identifier": "rpc.svcc.CService"
            },
            "backend": [{
                "url_pattern": "/rz/rpc.svcc.CService/CallServiceC",
                "encoding": "json",
                "sd": "custom",
                "service": "/rz/rpc.svcc.CService",
                "method": "CallServiceC",
                "extra_config": {
                    "twirp_service_identifier": "rpc.svcc.CService"
                },
                "host": [
                    "http://localhost:8083"

                ],

                "disable_host_sanitize": true
            }]
        },
        {
            "endpoint": "/rpc/{count}/get",
            "method": "GET",
            "output_encoding": "json",
            "querystring_params": [
                "*"
            ],
            "headers_to_pass": [
                "*"
            ],
            "extra_config": {
                "twirp_service_identifier": "rpc.svcc.CService"
            },
            "backend": [{
                "url_pattern": "/rz/rpc.svcc.CService/CallServiceC?count={count}",
                "encoding": "json",
                "sd": "custom",
                "method": "CallServiceC",
                "extra_config": {
                    "twirp_service_identifier": "rpc.svcc.CService",
                    "github.com/kyawmyintthein/lura-twirp/martian": {
                        "fifo.Group": {
                            "scope": ["request", "response"],
                            "aggregateErrors": true,
                            "modifiers": [{
                                "body.FromHeader": {
                                    "keys_to_extract": [
                                        "Count"
                                    ],
                                    "template": "{\"count\":{{index .Count 0}}}",
                                    "method": "POST"
                                }
                            }, {
                                "body.CustomModifier": {
                                    "scope": ["response"],
                                    "template": "WwogICAgewogICJvcGVyYXRpb24iOiAic2hpZnQiLAogICJzcGVjIjogewogICAgInJlc3VsdCI6ICJyZXNwb25zZXMiCiAgfQp9XQ==",
                                    "method": "POST"
                                }
                            }]
                        }

                    }
                },
                "host": [
                    "http://localhost:8083"

                ],

                "disable_host_sanitize": true
            }]
        },
        {
            "endpoint": "/svc/{count}/get",
            "method": "GET",
            "output_encoding": "json",
            "querystring_params": [
                "*"
            ],
            "headers_to_pass": [
                "*"
            ],

            "backend": [{
                "url_pattern": "/rz/rpc.svcc.CService/CallServiceC?count={count}",
                "encoding": "json",
                "sd": "custom",
                "method": "POST",
                "extra_config": {
                    "github.com/kyawmyintthein/lura-twirp/martian": {
                        "body.FromQueryString": {
                            "keys_to_extract": [
                                "count"
                            ],
                            "template": "{\"count\":{{index .count 0}}}",
                            "method": "POST"
                        }
                    }
                },
                "host": [
                    "http://localhost:8083"

                ],
                "disable_host_sanitize": true
            }]
        },
        {
            "endpoint": "/health",
            "method": "GET",
            "output_encoding": "no-op",
            "extra_config": {},
            "backend": [{
                "url_pattern": "/health",
                "encoding": "no-op",
                "sd": "custom",
                "method": "GET",
                "extra_config": {},
                "disable_host_sanitize": true,
                "host": [
                    "https://localhost:8083"
                ]
            }]
        }
    ]
}